{% extends "base.html" %}
{% load static %}
{% load companies_tags %}

{% block title %}
  {{ page_title }}
{% endblock title %}



{% block head %}
  {% autoescape off %}
    <style>
      body {
        max-height: 100dvh;
      }
      [data-form] {
        max-height: 27dvh;
        overflow: visible;
        overflow-y: auto;
      }
      @media (height >= 350px) { [data-form] { max-height: 33dvh; } }
      @media (height >= 400px) { [data-form] { max-height: 43dvh; } }
      @media (height >= 450px) { [data-form] { max-height: 50dvh; } }
      @media (height >= 550px) { [data-form] { max-height: 58dvh; } }
      @media (height >= 600px) { [data-form] { max-height: 63dvh; } }
      @media (height >= 700px) { [data-form] { max-height: 70dvh; } }
      @media (height >= 850px) { [data-form] { max-height: 74dvh; } }
      @media (height >= 1000px) { [data-form] { max-height: 78dvh; } }
    </style>
  {% endautoescape %}
{% endblock %}


{% block content %}
<div class="relative max-w-6xl mx-auto mt-5">
  {% if not request.GET.hide_navbar %}
  <div class="text-right pb-6">
  <a href="{% url view_url %}">View</a>
  </div>
  {% endif %}
    

  <style>
    .onboarding-task-group {
        display: grid;
        gap: 1rem;
        grid-template-columns: 1fr 1.5fr;
        margin-bottom: 1rem;
        align-items: baseline;
    }
    .onboarding-task-group .form-fields {
        display: flex;
        flex-direction: row;
        gap: 0.5rem;
    }
    .onboarding-task-group .form-group {
        display: flex;
        flex-direction: column;
        flex-wrap: no-wrap;
        flex-grow: 1;
    }
    .onboarding-task-group .form-group:first-child {
        flex-grow: 0;
    }
    .onboarding-task-group .form-group textarea {
        display: inline-block;
        height: 2.5rem;
    }
    .onboarding-task-group .name {
        display: grid;
        gap: 1rem;
        grid-template-columns: auto 1fr;
        align-items: center;
    }
    .onboarding-task-group .name hr {
        min-width: 0.5rem;
    }
  </style>

    <div data-form>
  <!-- form -->
    <p class="header update-header py-2 px-6 absolute -z-50 -top-3">{{ form_title }}</p>
    <!-- form -->
    {% for onboarding_task in limited_onboarding_tasks %}
    <form action="{% url update_url id %}" method='POST'  class="onboarding-task-group" data-task-id="{{ onboarding_task.task_id.id }}">
        <h2 class='name' class="header py-2 px-6 absolute -z-50 -top-3 update-header">
            <span>{{ onboarding_task.task_id.name }}</span>
            <hr>
        </h2>

        <div class='form-fields'>
            <span class="form-group">
                <label for="task_status_{{ onboarding_task.id }}">Status</label>
                <select name="task_status_{{ onboarding_task.id }}" id="task_status_{{ onboarding_task.id }}" data-field-name="task_status">
                    {% for choice in task_status_choices %}
                        <option value="{{ choice.0 }}" {% if choice.0 == onboarding_task.task_status %}selected{% endif %}>{{ choice.1 }}</option>
                    {% endfor %}
                </select>
            </span>
            <span class="form-group">
                <label for="task_note_{{ onboarding_task.id }}">Note</label>
                <textarea name="task_note_{{ onboarding_task.id }}" id="task_note_{{ onboarding_task.id }}" style="display: inline;" data-field-name="note">{{ onboarding_task.note }}</textarea>
            </span>
        </div>
    </form>
    {% endfor %}
    <button type="submit" class="update absolute translate-y-full -bottom-2">Update</button>
    </div>
</div>

<script defer type='module' src='{% static "js/limited_onboarding_tasks.js" %}'></script>

{% endblock content %}
