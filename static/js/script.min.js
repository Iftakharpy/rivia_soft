let typingTimer,template_querySelector="template#data-template",all_url=document.querySelector('input[name="all_url"]').value,search_url=document.querySelector('input[name="search_url_without_argument"]').value,update_url=document.querySelector('input[name="update_url_without_argument"]').value,delete_url=document.querySelector('input[name="delete_url_without_argument"]').value,fields=JSON.parse(document.querySelector('pre[name="model_fields"]').innerText.replaceAll("'",'"')),template_querySelector_string="template#data-template",template=document.querySelector(template_querySelector_string),DATA={all_url:all_url,search_url:search_url,update_url:update_url,delete_url:delete_url},delete_message_after=1e4;setTimeout(function(){let e=document.getElementsByClassName("message");if(e)for(let t of e)t.remove()},delete_message_after);let doneTypingInterval=1e3;const search_bar=document.querySelector('input[name="search"]');function get_tr_for_table(e,t=t,r=fields,n=DATA.update_url,a=DATA.delete_url){let o=t.content.cloneNode(!0),l=`${n}${e.pk}/`,u=`${a}${e.pk}/`;o.getElementById("edit").href=`${l}`,o.getElementById("delete").href=`${u}`;for(let t of r){let r=o.getElementById(t);if(r){let n=e.fields[t];if(!0!==n&&!1!==n)r.textContent=n;else{let e='<input type="checkbox" checked="" disabled>',t='<input type="checkbox" disabled>';r.innerHTML=n?e:t}}}return o}async function populate_with_data(e,t=get_tr_for_table,r=template_querySelector){let n=document.querySelector(r),a=document.querySelector("tbody#data");a.innerHTML="";for(let r of e){let e=t(r,n);a.appendChild(e)}}async function db_all_records(e=DATA.all_url){return await fetch_url(e,"GET").then(e=>e.json()).then(e=>e)}async function db_search_records(e,t=DATA.search_url){return await fetch_url(`${t}${e}/`,"GET").then(e=>e.json()).then(e=>e)}async function fetch_url(e,t,r={name:"IFTAKHAR HUSAN"},n={"Content-Type":"application/json"},a={}){if(deepCompare(a,{})&&(a={credentials:"same-origin",cache:"no-cache",mode:"cors",redirect:"follow",referrerPolicy:"no-referrer"}),"GET"==t.toUpperCase()){return await fetch(e,{method:t,headers:n,...a})}return await fetch(e,{method:t,headers:n,body:r,...a})}function deepCompare(){var e,t,r,n;function a(e,t){var o;if(isNaN(e)&&isNaN(t)&&"number"==typeof e&&"number"==typeof t)return!0;if(e===t)return!0;if("function"==typeof e&&"function"==typeof t||e instanceof Date&&t instanceof Date||e instanceof RegExp&&t instanceof RegExp||e instanceof String&&t instanceof String||e instanceof Number&&t instanceof Number)return e.toString()===t.toString();if(!(e instanceof Object&&t instanceof Object))return!1;if(e.isPrototypeOf(t)||t.isPrototypeOf(e))return!1;if(e.constructor!==t.constructor)return!1;if(e.prototype!==t.prototype)return!1;if(r.indexOf(e)>-1||n.indexOf(t)>-1)return!1;for(o in t){if(t.hasOwnProperty(o)!==e.hasOwnProperty(o))return!1;if(typeof t[o]!=typeof e[o])return!1}for(o in e){if(t.hasOwnProperty(o)!==e.hasOwnProperty(o))return!1;if(typeof t[o]!=typeof e[o])return!1;switch(typeof e[o]){case"object":case"function":if(r.push(e),n.push(t),!a(e[o],t[o]))return!1;r.pop(),n.pop();break;default:if(e[o]!==t[o])return!1}}return!0}if(arguments.length<1)return!0;for(e=1,t=arguments.length;e<t;e++)if(r=[],n=[],!a(arguments[0],arguments[e]))return!1;return!0}function sleep(e){const t=Date.now();let r=null;do{r=Date.now()}while(r-t<e)}search_bar&&(search_bar.addEventListener("input",e=>{let t=DATA.search_url,r=search_bar.value.trim();clearTimeout(typingTimer),typingTimer=""===r?setTimeout(async()=>{populate_with_data(await db_all_records())},doneTypingInterval):setTimeout(async(e,t)=>{populate_with_data(await db_search_records(e,t))},doneTypingInterval,r,t)}),window.addEventListener("load",()=>{setTimeout(async()=>{populate_with_data(await db_all_records())},10)}));